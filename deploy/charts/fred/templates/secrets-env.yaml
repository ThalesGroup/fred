{{- define "common-library.secrets-env" -}}
{{- if and .app.configuration_type.backend (or (eq .app.configuration_type.backend true) (eq .app.configuration_type.backend.enabled true)) }}

---
apiVersion: v1
kind: Secret
metadata:
  name: {{ .app.applicationName }}-env
stringData:
  .env: |
    # This file contains the environment variables for the application

    {{- if .app.dotenv.KEYCLOAK_AGENTIC_CLIENT_SECRET }}
    KEYCLOAK_AGENTIC_CLIENT_SECRET="{{ .app.dotenv.KEYCLOAK_AGENTIC_CLIENT_SECRET }}"
    {{- else }}
    #KEYCLOAK_AGENTIC_CLIENT_SECRET=""
    {{- end }}
    # Keycloak service account token

    {{- if .app.dotenv.KEYCLOAK_KNOWLEDGE_FLOW_CLIENT_SECRET }}
    KEYCLOAK_KNOWLEDGE_FLOW_CLIENT_SECRET="{{ .app.dotenv.KEYCLOAK_KNOWLEDGE_FLOW_CLIENT_SECRET }}"
    {{- else }}
    #KEYCLOAK_KNOWLEDGE_FLOW_CLIENT_SECRET=""
    {{- end }}
    # Keycloak service account token

    # -----------------------------------------------------------------------------
    # ðŸ”µ AZURE AUTHENTICATION (for getting OAuth token)
    # -----------------------------------------------------------------------------
    
    {{- if .app.dotenv.AZURE_TENANT_ID }}
    AZURE_TENANT_ID="{{ .app.dotenv.AZURE_TENANT_ID }}"
    {{- else }}
    #AZURE_TENANT_ID=""
    {{- end }}
    # Azure Active Directory Tenant ID for your application (OAuth 2.0 flow)

    {{- if .app.dotenv.AZURE_CLIENT_ID }}
    AZURE_CLIENT_ID="{{ .app.dotenv.AZURE_CLIENT_ID }}"
    {{- else }}
    #AZURE_CLIENT_ID=""
    {{- end }}
    # Client ID of your registered Azure AD Application (Service Principal)

    {{- if .app.dotenv.AZURE_CLIENT_SECRET }}
    AZURE_CLIENT_SECRET="{{ .app.dotenv.AZURE_CLIENT_SECRET }}"
    {{- else }}
    #AZURE_CLIENT_SECRET=""
    {{- end }}
    # Client Secret of your Azure AD Application

    {{- if .app.dotenv.AZURE_CLIENT_SCOPE }}
    AZURE_CLIENT_SCOPE="{{ .app.dotenv.AZURE_CLIENT_SCOPE }}"
    {{- else }}
    #AZURE_CLIENT_SCOPE=""
    {{- end }}
    # OAuth2 scope for requesting tokens (typically "https://cognitiveservices.azure.com/.default")

    # -----------------------------------------------------------------------------
    # ðŸ”µ AZURE API SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.AZURE_API_VERSION }}
    AZURE_API_VERSION="{{ .app.dotenv.AZURE_API_VERSION }}"
    {{- else }}
    #AZURE_API_VERSION=""
    {{- end }}
    # API version used for Azure OpenAI API requests (depends on your Azure resource)

    # -----------------------------------------------------------------------------
    # ðŸ”µ API GATEWAY (APIM) SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.AZURE_APIM_BASE_URL }}
    AZURE_APIM_BASE_URL="{{ .app.dotenv.AZURE_APIM_BASE_URL }}"
    {{- else }}
    #AZURE_APIM_BASE_URL=""
    {{- end }}
    # Base URL of your Azure API Management Gateway (APIM)
    # Example: https://company-apim-gateway.azure-api.net

    {{- if .app.dotenv.AZURE_RESOURCE_PATH_EMBEDDINGS }}
    AZURE_RESOURCE_PATH_EMBEDDINGS="{{ .app.dotenv.AZURE_RESOURCE_PATH_EMBEDDINGS }}"
    {{- else }}
    #AZURE_RESOURCE_PATH_EMBEDDINGS=""
    {{- end }}
    # Path after base URL for Embeddings API (before /deployments/...)

    {{- if .app.dotenv.AZURE_RESOURCE_PATH_LLM }}
    AZURE_RESOURCE_PATH_LLM="{{ .app.dotenv.AZURE_RESOURCE_PATH_LLM }}"
    {{- else }}
    #AZURE_RESOURCE_PATH_LLM=""
    {{- end }}
    # Path after base URL for LLM Chat API (before /deployments/...)

    {{- if .app.dotenv.AZURE_APIM_KEY }}
    AZURE_APIM_KEY="{{ .app.dotenv.AZURE_APIM_KEY }}"
    {{- else }}
    #AZURE_APIM_KEY=""
    {{- end }}
    # Subscription Key required by the APIM Gateway ("TrustNest-Apim-Subscription-Key" header)

    # -----------------------------------------------------------------------------
    # ðŸ”µ AZURE OPENAI DIRECT SETTINGS (if AZURE_USE_APIM=false)
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.AZURE_OPENAI_ENDPOINT }}
    AZURE_OPENAI_ENDPOINT="{{ .app.dotenv.AZURE_OPENAI_ENDPOINT }}"
    {{- else }}
    #AZURE_OPENAI_ENDPOINT=""
    {{- end }}
    # Base URL for direct Azure OpenAI access (no APIM)

    {{- if .app.dotenv.AZURE_OPENAI_API_KEY }}
    AZURE_OPENAI_API_KEY="{{ .app.dotenv.AZURE_OPENAI_API_KEY }}"
    {{- else }}
    #AZURE_OPENAI_API_KEY=""
    {{- end }}
    # Azure OpenAI API Key (directly from Azure portal, not APIM key)

    # -----------------------------------------------------------------------------
    # ðŸ”µ AZURE OPENAI DEPLOYMENT NAMES
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.AZURE_DEPLOYMENT_LLM }}
    AZURE_DEPLOYMENT_LLM="{{ .app.dotenv.AZURE_DEPLOYMENT_LLM }}"
    {{- else }}
    #AZURE_DEPLOYMENT_LLM=""
    {{- end }}
    # Deployment name in Azure OpenAI for Chat LLMs (ex: GPT-4 Turbo, GPT-4o)

    {{- if .app.dotenv.AZURE_DEPLOYMENT_EMBEDDING }}
    AZURE_DEPLOYMENT_EMBEDDING="{{ .app.dotenv.AZURE_DEPLOYMENT_EMBEDDING }}"
    {{- else }}
    #AZURE_DEPLOYMENT_EMBEDDING=""
    {{- end }}
    # Deployment name in Azure OpenAI for Embedding Models

    # -----------------------------------------------------------------------------
    # ðŸ”µ OPENAI EMBEDDING (Public API - NOT Azure)
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.OPENAI_API_KEY }}
    OPENAI_API_KEY="{{ .app.dotenv.OPENAI_API_KEY }}"
    {{- else }}
    #OPENAI_API_KEY=""
    {{- end }}
    # Your OpenAI API key from https://platform.openai.com/account/api-keys

    # OPENAI_API_BASE="https://api.openai.com/v1"
    # Optional. Defaults to https://api.openai.com/v1 for OpenAI public API

    {{- if .app.dotenv.OPENAI_API_VERSION }}
    OPENAI_API_VERSION="{{ .app.dotenv.OPENAI_API_VERSION }}"
    {{- else }}
    #OPENAI_API_VERSION=""
    {{- end }}
    # Leave blank for OpenAI public API (only needed for Azure)
    # Example (Azure only): "2024-06-01"

    # Example model for embeddings (default for OpenAI)
    # OPENAI_MODEL_NAME="text-embedding-ada-002"

    # -----------------------------------------------------------------------------
    # ðŸ”µ OLLAMA SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.OLLAMA_API_URL }}
    OLLAMA_API_URL="{{ .app.dotenv.OLLAMA_API_URL }}"
    {{- else }}
    #OLLAMA_API_URL=""
    {{- end }}
    # Ollama API URL (optional)

    {{- if .app.dotenv.OLLAMA_EMBEDDING_MODEL_NAME }}
    OLLAMA_EMBEDDING_MODEL_NAME="{{ .app.dotenv.OLLAMA_EMBEDDING_MODEL_NAME }}"
    {{- else }}
    #OLLAMA_EMBEDDING_MODEL_NAME=""
    {{- end }}
    # Model name for embeddings

    {{- if .app.dotenv.OLLAMA_VISION_MODEL_NAME }}
    OLLAMA_VISION_MODEL_NAME="{{ .app.dotenv.OLLAMA_VISION_MODEL_NAME }}"
    {{- else }}
    #OLLAMA_VISION_MODEL_NAME=""
    {{- end }}
    # Model name for vision tasks (optional)

    # -----------------------------------------------------------------------------
    # ðŸ”µ KEYCLOAK SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.KEYCLOAK_SERVER_URL }}
    KEYCLOAK_SERVER_URL="{{ .app.dotenv.KEYCLOAK_SERVER_URL }}"
    {{- else }}
    #KEYCLOAK_SERVER_URL=""
    {{- end }}
    {{- if .app.dotenv.KEYCLOAK_REALM_NAME }}
    KEYCLOAK_REALM_NAME="{{ .app.dotenv.KEYCLOAK_REALM_NAME }}"
    {{- else }}
    #KEYCLOAK_REALM_NAME=""
    {{- end }}
    {{- if .app.dotenv.KEYCLOAK_CLIENT_ID }}
    KEYCLOAK_CLIENT_ID="{{ .app.dotenv.KEYCLOAK_CLIENT_ID }}"
    {{- else }}
    #KEYCLOAK_CLIENT_ID=""
    {{- end }}

    # -----------------------------------------------------------------------------
    # ðŸ”µ OPENSEARCH SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.OPENSEARCH_PASSWORD }}
    OPENSEARCH_PASSWORD="{{ .app.dotenv.OPENSEARCH_PASSWORD }}"
    {{- else }}
    #OPENSEARCH_PASSWORD=""
    {{- end }}

    # -----------------------------------------------------------------------------
    # ðŸ”µ MINIO SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.MINIO_ACCESS_KEY }}
    MINIO_ACCESS_KEY="{{ .app.dotenv.MINIO_ACCESS_KEY }}"
    {{- else }}
    #MINIO_ACCESS_KEY=""
    {{- end }}
    {{- if .app.dotenv.MINIO_SECRET_KEY }}
    MINIO_SECRET_KEY="{{ .app.dotenv.MINIO_SECRET_KEY }}"
    {{- else }}
    #MINIO_SECRET_KEY=""
    {{- end }}

    # -----------------------------------------------------------------------------
    # ðŸ”µ GCS SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.GCS_CREDENTIALS_PATH }}
    GCS_CREDENTIALS_PATH="{{ .app.dotenv.GCS_CREDENTIALS_PATH }}"
    {{- else }}
    #GCS_CREDENTIALS_PATH=""
    {{- end }}
    {{- if .app.dotenv.GCS_BUCKET_NAME }}
    GCS_BUCKET_NAME="{{ .app.dotenv.GCS_BUCKET_NAME }}"
    {{- else }}
    #GCS_BUCKET_NAME=""
    {{- end }}
    {{- if .app.dotenv.GCS_PROJECT_ID }}
    GCS_PROJECT_ID="{{ .app.dotenv.GCS_PROJECT_ID }}"
    {{- else }}
    #GCS_PROJECT_ID=""
    {{- end }}

    # -----------------------------------------------------------------------------
    # ðŸ”µ LOCAL STORAGE SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.LOCAL_CONTENT_STORAGE_PATH }}
    LOCAL_CONTENT_STORAGE_PATH="{{ .app.dotenv.LOCAL_CONTENT_STORAGE_PATH }}"
    {{- else }}
    #LOCAL_CONTENT_STORAGE_PATH=""
    {{- end }}
    {{- if .app.dotenv.LOCAL_METADATA_STORAGE_PATH }}
    LOCAL_METADATA_STORAGE_PATH="{{ .app.dotenv.LOCAL_METADATA_STORAGE_PATH }}"
    {{- else }}
    #LOCAL_METADATA_STORAGE_PATH=""
    {{- end }}

    # -----------------------------------------------------------------------------
    # ðŸ”µ SQL DATABASE STORAGE SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.SQL_USERNAME }}
    SQL_USERNAME="{{ .app.dotenv.SQL_USERNAME }}"
    {{- else }}
    #SQL_USERNAME=""
    {{- end }}
    {{- if .app.dotenv.SQL_PASSWORD }}
    SQL_PASSWORD="{{ .app.dotenv.SQL_PASSWORD }}"
    {{- else }}
    #SQL_PASSWORD=""
    {{- end }}
{{- end }}
{{ end -}}