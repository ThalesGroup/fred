{{- define "common-library.secrets-env" -}}
{{- if and .app.configuration_type.backend (or (eq .app.configuration_type.backend true) (eq .app.configuration_type.backend.enabled true)) }}

---
apiVersion: v1
kind: Secret
metadata:
  name: {{ .app.applicationName }}-env
stringData:
  .env: |
    # This file contains the environment variables for the application

    {{- if .app.dotenv.KEYCLOAK_AGENTIC_CLIENT_SECRET }}
    KEYCLOAK_AGENTIC_CLIENT_SECRET="{{ .app.dotenv.KEYCLOAK_AGENTIC_CLIENT_SECRET }}"
    {{- else }}
    #KEYCLOAK_AGENTIC_CLIENT_SECRET=""
    {{- end }}
    # Keycloak service account token

    {{- if .app.dotenv.KEYCLOAK_KNOWLEDGE_FLOW_CLIENT_SECRET }}
    KEYCLOAK_KNOWLEDGE_FLOW_CLIENT_SECRET="{{ .app.dotenv.KEYCLOAK_KNOWLEDGE_FLOW_CLIENT_SECRET }}"
    {{- else }}
    #KEYCLOAK_KNOWLEDGE_FLOW_CLIENT_SECRET=""
    {{- end }}
    # Keycloak service account token

    # -----------------------------------------------------------------------------
    # ðŸ”µ AZURE AUTHENTICATION (for getting OAuth token)
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.AZURE_AD_CLIENT_SECRET }}
    AZURE_AD_CLIENT_SECRET="{{ .app.dotenv.AZURE_AD_CLIENT_SECRET }}"
    {{- else }}
    #AZURE_AD_CLIENT_SECRET=""
    {{- end }}
    # Client Secret of your Azure AD Application

    # -----------------------------------------------------------------------------
    # ðŸ”µ API GATEWAY (APIM) SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.AZURE_APIM_SUBSCRIPTION_KEY }}
    AZURE_APIM_SUBSCRIPTION_KEY="{{ .app.dotenv.AZURE_APIM_SUBSCRIPTION_KEY }}"
    {{- else }}
    #AZURE_APIM_SUBSCRIPTION_KEY=""
    {{- end }}
    # Subscription Key required by the APIM Gateway ("TrustNest-Apim-Subscription-Key" header)

    # -----------------------------------------------------------------------------
    # ðŸ”µ AZURE OPENAI DIRECT SETTINGS (if AZURE_USE_APIM=false)
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.AZURE_OPENAI_API_KEY }}
    AZURE_OPENAI_API_KEY="{{ .app.dotenv.AZURE_OPENAI_API_KEY }}"
    {{- else }}
    #AZURE_OPENAI_API_KEY=""
    {{- end }}
    # Azure OpenAI API Key (directly from Azure portal, not APIM key)

    # -----------------------------------------------------------------------------
    # ðŸ”µ OPENAI EMBEDDING (Public API - NOT Azure)
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.OPENAI_API_KEY }}
    OPENAI_API_KEY="{{ .app.dotenv.OPENAI_API_KEY }}"
    {{- else }}
    #OPENAI_API_KEY=""
    {{- end }}
    # Your OpenAI API key from https://platform.openai.com/account/api-keys

    # -----------------------------------------------------------------------------
    # ðŸ”µ OPENSEARCH SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.OPENSEARCH_PASSWORD }}
    OPENSEARCH_PASSWORD="{{ .app.dotenv.OPENSEARCH_PASSWORD }}"
    {{- else }}
    #OPENSEARCH_PASSWORD=""
    {{- end }}

    # -----------------------------------------------------------------------------
    # ðŸ”µ MINIO SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.MINIO_ACCESS_KEY }}
    MINIO_ACCESS_KEY="{{ .app.dotenv.MINIO_ACCESS_KEY }}"
    {{- else }}
    #MINIO_ACCESS_KEY=""
    {{- end }}
    {{- if .app.dotenv.MINIO_SECRET_KEY }}
    MINIO_SECRET_KEY="{{ .app.dotenv.MINIO_SECRET_KEY }}"
    {{- else }}
    #MINIO_SECRET_KEY=""
    {{- end }}

    # -----------------------------------------------------------------------------
    # ðŸ”µ GCS SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.GCS_CREDENTIALS_PATH }}
    GCS_CREDENTIALS_PATH="{{ .app.dotenv.GCS_CREDENTIALS_PATH }}"
    {{- else }}
    #GCS_CREDENTIALS_PATH=""
    {{- end }}
    {{- if .app.dotenv.GCS_BUCKET_NAME }}
    GCS_BUCKET_NAME="{{ .app.dotenv.GCS_BUCKET_NAME }}"
    {{- else }}
    #GCS_BUCKET_NAME=""
    {{- end }}
    {{- if .app.dotenv.GCS_PROJECT_ID }}
    GCS_PROJECT_ID="{{ .app.dotenv.GCS_PROJECT_ID }}"
    {{- else }}
    #GCS_PROJECT_ID=""
    {{- end }}

    # -----------------------------------------------------------------------------
    # ðŸ”µ SQL DATABASE STORAGE SETTINGS
    # -----------------------------------------------------------------------------

    {{- if .app.dotenv.SQL_USERNAME }}
    SQL_USERNAME="{{ .app.dotenv.SQL_USERNAME }}"
    {{- else }}
    #SQL_USERNAME=""
    {{- end }}
    {{- if .app.dotenv.SQL_PASSWORD }}
    SQL_PASSWORD="{{ .app.dotenv.SQL_PASSWORD }}"
    {{- else }}
    #SQL_PASSWORD=""
    {{- end }}

    # -----------------------------------------------------------------------------
    # ðŸ”µ OPENFGA SETTINGS
    # -----------------------------------------------------------------------------
    {{- if .app.dotenv.OPENFGA_API_TOKEN }}
    OPENFGA_API_TOKEN="{{ .app.dotenv.OPENFGA_API_TOKEN }}"
    {{- else }}
    #OPENFGA_API_TOKEN=""
    {{- end }}

{{- end }}
{{ end -}}